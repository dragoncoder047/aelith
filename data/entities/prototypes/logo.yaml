model:
  skeleton:
    - name: centerpos
      pos: { x: 0, y: 100 }
      children:
        - name: logo
          pos: { x: 0, y: -75 }
          render:
            as: sprite
            sprite: logoletters
            anchor: top
            angle: 0
            scale: { x: 0.8, y: 0.8 }
          children:
            - name: particles
              render:
                as: particles
                time: [0.25, 0.5]
                speed: [100, 150]
                acc: [{ x: 0, y: 300 }, { x: 0, y: 500 }]
                damp: [0, 10]
                dir: -90
                pps: 20
                spread: 160
                anim:
                  color: [cyan]
                  trans: [0.7]
                  scale: [2.5]
            - name: splash
              pos: { x: 200, y: 110 }
              render:
                as: text
                anchor: topright
                text: ""
                size: 12
                color: yellow
                width: 300
                align: right
            - name: laser
              pos: { x: &laserX -151.5, y: 71 }
              render:
                as: sprite
                sprite: logolaser
                anchor: bot
                shader: barberpole
                uniform:
                  u_barwidth: 15
                  u_colors: [cyan]
                  u_nColors: 1
                  u_quadsize: quadsize
                  u_framesize: framesize

  anims:
    1:
      loop: true
      autoplay: true
      channels:
        - target: [logo, pos]
          relative: true
          keyframes:
            - [3.1, { x: 0, y: -5 }, easeInOutSine]
            - [3.1, { x: 0, y: 5 }, easeInOutSine]
        - target: [logo, angle]
          delay: -2
          keyframes:
            - [2.4, -1, easeInOutSine]
            - [2.4, 1, easeInOutSine]
        - target: [logo, scale]
          delay: -4
          keyframes:
            - [2.6, { x: 0.79, y: 0.79 }, easeInOutSine]
            - [2.6, { x: 0.82, y: 0.82 }, easeInOutSine]
hooks:
  setup:
    [
      boneSet,
      [list, splash, t],
      [+, "&splashes.", [randi, 0, [toNumber, [expand, "&splashes.length"]]]],
    ]
  render:
    - do
    - [
        boneSet,
        [list, particles, worldPos],
        [vec2, [nth, 0, [xys, [boneGet, [list, particles, worldPos]]]], 0],
      ]
    - [
        boneSet,
        [list, particles, pos],
        [vec2, *laserX, [boneGet, [list, particles, pos, "y"]]],
      ]
    - [
        boneSet,
        [list, particles, particles, rate],
        [lerp, 20, 1500, [getanalog, throw]], # TODO: update this if right trigger is reassigned.
      ]
