tags: [spaceship]
physics:
  - [rect, -88, -44, 176, 88]
  - [noColl, explorer]
navHeight: { x: 1, y: 1 }
behavior:
  canBePlayer: yes
  camScale: 0.8
  moveSpeed: 1000
  inventorySlots: 20
  inventorySize: null
  # inventoryHolder: interior
model:
  skeleton:
    - name: gazeTarget
    - name: body
      render:
        as: sprite
        sprite: spaceship
        anchor: center
        frame: 2
        z: 0
      children:
        - name: backdoor
          render:
            as: sprite
            sprite: spaceship
            anchor: center
            frame: 1
            z: -1
        - name: interior
          render:
            as: sprite
            sprite: spaceship
            anchor: center
            frame: 0
            z: -1
        - name: frontdoor
          render:
            as: sprite
            sprite: spaceship
            anchor: center
            frame: 1
            z: 0
  tentacles:
    - &st
      name: ta
      bone: body
      render:
        color: xt250
        cap: round
        z: -1
      pos: { x: 40, y: 20 }
      n: 8
      lps: 6
      sizes: [12, 1]
      masses: [1, 1]
      gravityIsLocal: yes
      eachConstraint: [angle, body, 1, -90]
    - <<: *st
      name: tb
      pos: { x: 40, y: -30 }
  kinematics:
    look:
      origin: body
      target: gazeTarget
    initial: flying
    states:
      flying:
        gravityScale: 0
        bones:
          - bone: body
            flip: [false, true]
  anims:
    doorOpen:
      cancel: [doorClose]
      channels:
        - target: [frontdoor, pos]
          keyframes:
            - [&doorTime 1, { x: 0, y: 0 }]
            - [0, { x: 0, y: &doorMotion -64 }]
        - target: [frontdoor, angle]
          keyframes:
            - [*doorTime, 0]
            - [0, &doorTilt -30]
    doorClose:
      cancel: [doorOpen]
      channels:
        - target: [frontdoor, pos]
          keyframes:
            - [*doorTime, { x: 0, y: *doorMotion }]
            - [0, { x: 0, y: 0 }]
        - target: [frontdoor, angle]
          keyframes:
            - [*doorTime, *doorTilt]
            - [0, 0]
hooks:
  setup: [do, [be, doorOpen, false]]
  stateChanged:
    - switch
    - [the, slot]
    - doorOpen: [anim, [if, [the, value], doorOpen, doorClose]]
  action1: [be, doorOpen, [not, [my, doorOpen]]]
